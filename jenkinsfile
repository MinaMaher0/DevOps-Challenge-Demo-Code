pipeline {
    agent none
    stages {
        stage('Build And Test on Development environment') {
            agent { label 'development' }
            stages{
                stage('build App image'){
                    steps {
                        sh 'docker build -t torando:latest .'
                    }
                }
                
                stage('deploy on development environment'){
                    steps {
                        sh 'docker-compose up -d --abort-on-container-exit'
                    }
                }
            }
        }
        stage('Deploy on Production environment') {
            agent { label 'production' }
            stages{
                
                stage('build App image'){
                    steps {
                        sh 'docker build -t torando:latest .'
                    }
                }
                stage('deploy on production envirnment'){
                    steps {
                        sh 'docker-compose up -d --abort-on-container-exit"'
                    }
                }
            }
        }
    }
}